<Window x:Class="JPMCGenAI_v1._0.NormalizePreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Normalized Steps Review"
        Height="700" Width="1200"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip"
        Background="#F5F7FA"
        FontFamily="Segoe UI">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Testcase Selector -->
        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0 0 0 15">
            <TextBlock Text="Select Test Case:" 
                       VerticalAlignment="Center" 
                       Margin="0 0 12 0" 
                       FontWeight="SemiBold"
                       Foreground="#2D3748"
                       FontSize="14"/>
            <ComboBox x:Name="TestCaseSelector"
                      Width="380"
                      Height="36"
                      FontSize="13"
                      Padding="10 8"
                      SelectionChanged="TestCaseSelector_SelectionChanged"
                      VerticalContentAlignment="Center"/>
        </StackPanel>

        <!-- Two-Column Step Comparison -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Original Steps (Read-Only) -->
            <GroupBox Header="Original Steps" 
                      Grid.Column="0" 
                      Margin="0 0 8 0"
                      Padding="10"
                      BorderBrush="#CBD5E0"
                      BorderThickness="1"
                      Background="White">
                <GroupBox.HeaderTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" 
                                   FontWeight="Bold" 
                                   FontSize="14" 
                                   Foreground="#2D3748"/>
                    </DataTemplate>
                </GroupBox.HeaderTemplate>

                <DataGrid x:Name="OriginalGrid"
                          IsReadOnly="True"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          GridLinesVisibility="All"
                          HeadersVisibility="Column"
                          AlternationCount="2"
                          RowBackground="White"
                          AlternatingRowBackground="#F8FAFC"
                          BorderThickness="0"
                          FontSize="13"
                          RowHeight="38"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Auto">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header=" # " 
                                            Binding="{Binding Index}" 
                                            Width="60"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Foreground" Value="#4A5568"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Step Description" 
                                            Binding="{Binding Step}" 
                                            Width="2*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Padding" Value="8 6"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Test Data" 
                                            Binding="{Binding TestDataText}" 
                                            Width="220"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Padding" Value="8 6"/>
                                    <Setter Property="Foreground" Value="#718096"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>

            <!-- Normalized Steps (Editable) -->
            <GroupBox Header="Normalized Steps (Edit &amp; Save)" 
                      Grid.Column="1" 
                      Margin="8 0 0 0"
                      Padding="10"
                      BorderBrush="#63B3ED"
                      BorderThickness="2"
                      Background="#EBF8FF">
                <GroupBox.HeaderTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" 
                                   FontWeight="Bold" 
                                   FontSize="14" 
                                   Foreground="#1E40AF"/>
                    </DataTemplate>
                </GroupBox.HeaderTemplate>

                <DataGrid x:Name="NormalizedGrid"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          GridLinesVisibility="All"
                          HeadersVisibility="Column"
                          AlternationCount="2"
                          RowBackground="White"
                          AlternatingRowBackground="#EBF8FF"
                          BorderThickness="0"
                          FontSize="13"
                          RowHeight="38"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Auto">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header=" # " 
                                            Binding="{Binding Index}" 
                                            Width="60"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Foreground" Value="#1E40AF"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- Editable Step -->
                        <DataGridTextColumn Header="Step Description" 
                                            Binding="{Binding Step, UpdateSourceTrigger=PropertyChanged}" 
                                            Width="2*">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Padding" Value="8 6"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                            <DataGridTextColumn.EditingElementStyle>
                                <Style TargetType="TextBox">
                                    <Setter Property="Padding" Value="6"/>
                                    <Setter Property="BorderThickness" Value="1"/>
                                    <Setter Property="BorderBrush" Value="#4299E1"/>
                                </Style>
                            </DataGridTextColumn.EditingElementStyle>
                        </DataGridTextColumn>

                        <!-- Editable Test Data Text -->
                        <DataGridTextColumn Header="Test Data" 
                                            Binding="{Binding TestDataText, UpdateSourceTrigger=PropertyChanged}" 
                                            Width="220">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Padding" Value="8 6"/>
                                    <Setter Property="Foreground" Value="#2B6CB0"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                            <DataGridTextColumn.EditingElementStyle>
                                <Style TargetType="TextBox">
                                    <Setter Property="Padding" Value="6"/>
                                    <Setter Property="BorderBrush" Value="#4299E1"/>
                                </Style>
                            </DataGridTextColumn.EditingElementStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>
        </Grid>

        <!-- Bottom Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0 20 0 10">
            <Button Content="Cancel" 
                    Width="130" 
                    Height="42" 
                    Margin="0 0 12 0" 
                    Click="Cancel_Click"
                    Background="#A0AEC0" 
                    Foreground="White"
                    FontSize="14"
                    FontWeight="Medium"
                    Padding="10 8"
                    Cursor="Hand"/>
            
            <Button Content="Save Changes" 
                    Width="160" 
                    Height="42" 
                    Click="Save_Click"
                    Background="#48BB78" 
                    Foreground="White"
                    FontSize="14"
                    FontWeight="Medium"
                    Padding="10 8"
                    Cursor="Hand">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            CornerRadius="6"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" 
                                                          VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#38A169"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Button.Style>
            </Button>
        </StackPanel>
    </Grid>
</Window>
